---
title: 关于v-bind与v-model的父子传参问题
tags:
  - vue
categories:
  - 前端
comments: true
date: 2022-06-14 15:24:39
---
最近用Vue3写一个组件，Vue2都没用熟也硬上了。一个组件越写越大，梳理好逻辑后决定把显示和录入拆分开。

用第三方组件库太顺手，一开始用的是v-bind的写法。因为v-bind是单向数据流，需要在子组件里用 `emit` 触发父组件的方法，就和下面的例子一样。

<iframe style="width:100%;height:400px" src="https://sfc.vuejs.org/#__DEV__eyJBcHAudnVlIjoiPHNjcmlwdCBzZXR1cD5cbmltcG9ydCB7IHJlZiB9IGZyb20gJ3Z1ZSdcbmltcG9ydCBDaGlsZCBmcm9tICcuL2NoaWxkLnZ1ZSdcbmNvbnN0IGNvdW50ID0gcmVmKDApXG48L3NjcmlwdD5cblxuPHRlbXBsYXRlPlxuICA8aDE+di1iaW5kPC9oMT5cbiAgPGgxPnt7IGNvdW50IH19PC9oMT5cbiAgPGJ1dHRvbiBAY2xpY2s9XCJjb3VudCsrXCI+ZmF0aGVyIGFkZDwvYnV0dG9uPlxuICA8Q2hpbGQgOmNvdW50PVwiY291bnRcIiBAY291bnRDaGFuZ2U9XCJjb3VudCsrXCIvPlxuPC90ZW1wbGF0ZT4iLCJpbXBvcnQtbWFwLmpzb24iOiJ7XG4gIFwiaW1wb3J0c1wiOiB7XG4gICAgXCJ2dWVcIjogXCJodHRwczovL3VucGtnLmNvbS9AdnVlL3J1bnRpbWUtZG9tQDMuMi4zNy9kaXN0L3J1bnRpbWUtZG9tLmVzbS1icm93c2VyLmpzXCIsXG4gICAgXCJ2dWUvc2VydmVyLXJlbmRlcmVyXCI6IFwiaHR0cHM6Ly91bnBrZy5jb20vQHZ1ZS9zZXJ2ZXItcmVuZGVyZXJAMy4yLjM3L2Rpc3Qvc2VydmVyLXJlbmRlcmVyLmVzbS1icm93c2VyLmpzXCJcbiAgfVxufSIsImNoaWxkLnZ1ZSI6IjxzY3JpcHQgc2V0dXA+XG5pbXBvcnQgeyByZWYgfSBmcm9tICd2dWUnXG5jb25zdCBwcm9wcz1kZWZpbmVQcm9wcyh7Y291bnQ6TnVtYmVyfSlcbmNvbnN0IGVtaXQgPSBkZWZpbmVFbWl0cyhbJ2NvdW50Q2hhbmdlJ10pXG48L3NjcmlwdD5cblxuPHRlbXBsYXRlPlxuICA8aDE+e3sgcHJvcHMuY291bnQgfX08L2gxPlxuICA8YnV0dG9uIEBjbGljaz1cImVtaXQoJ2NvdW50Q2hhbmdlJylcIj5jaGlsZCBhZGQ8L2J1dHRvbj5cbjwvdGVtcGxhdGU+In0="></iframe>
  
例子中，无论是从父组件还是子组件修改，都能双向同步。实际项目的逻辑只会更复杂，像这样子把更新的逻辑放到父组件里会显得很割裂，父组件也不应该处理更新的逻辑，而应该把更新的逻辑放到子组件里。

一开始就是这样写，但越写越难受，然后就在想，有没有一种优雅一点的写法，就像是第三方组件库里实现的。回头找element-ui的源码，发现类似的组件用的是 `v-model`。恍然大悟！一直都是拿来主义，还真没留意到v-model。

缝缝补补写了个demo，把v-bind的写法改成v-model，子组件通过 `emit` 触发 `update:count` 就可以更新父组件的值了，就像下面的例子一样。

<iframe style="width:100%;height:400px" src="https://sfc.vuejs.org/#__DEV__eyJBcHAudnVlIjoiPHNjcmlwdCBzZXR1cD5cbmltcG9ydCB7IHJlZiB9IGZyb20gJ3Z1ZSdcbmltcG9ydCBDaGlsZCBmcm9tICcuL2NoaWxkLnZ1ZSdcbmNvbnN0IGNvdW50ID0gcmVmKDApXG48L3NjcmlwdD5cblxuPHRlbXBsYXRlPlxuICA8aDE+di1tb2RlbDwvaDE+XG4gIDxoMT57eyBjb3VudCB9fTwvaDE+XG4gIDxidXR0b24gQGNsaWNrPVwiY291bnQrK1wiPmZhdGhlciBhZGQ8L2J1dHRvbj5cbiAgPENoaWxkIHYtbW9kZWw6Y291bnQ9XCJjb3VudFwiLz5cbjwvdGVtcGxhdGU+IiwiaW1wb3J0LW1hcC5qc29uIjoie1xuICBcImltcG9ydHNcIjoge1xuICAgIFwidnVlXCI6IFwiaHR0cHM6Ly91bnBrZy5jb20vQHZ1ZS9ydW50aW1lLWRvbUAzLjIuMzcvZGlzdC9ydW50aW1lLWRvbS5lc20tYnJvd3Nlci5qc1wiLFxuICAgIFwidnVlL3NlcnZlci1yZW5kZXJlclwiOiBcImh0dHBzOi8vdW5wa2cuY29tL0B2dWUvc2VydmVyLXJlbmRlcmVyQDMuMi4zNy9kaXN0L3NlcnZlci1yZW5kZXJlci5lc20tYnJvd3Nlci5qc1wiXG4gIH1cbn0iLCJjaGlsZC52dWUiOiI8c2NyaXB0IHNldHVwPlxuaW1wb3J0IHsgcmVmLHdhdGNoIH0gZnJvbSAndnVlJ1xuY29uc3QgcHJvcHM9ZGVmaW5lUHJvcHMoe1xuICBjb3VudDp7XG4gICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICBkZWZhdWx0OiAwXG4gIH1cbn0pXG5jb25zdCBjb3VudCA9cmVmKHByb3BzLmNvdW50KVxud2F0Y2goKCkgPT4gcHJvcHMuY291bnQsICgpID0+IHsgY291bnQudmFsdWUgPSBwcm9wcy5jb3VudCB9KVxuY29uc3QgZW1pdCA9IGRlZmluZUVtaXRzKFtcbiAgICAndXBkYXRlOmNvdW50J1xuXSlcbmZ1bmN0aW9uIGFkZChlKXtcbiAgY291bnQudmFsdWUrK1xuICBlbWl0KCd1cGRhdGU6Y291bnQnLGNvdW50LnZhbHVlKVxufVxuPC9zY3JpcHQ+XG5cbjx0ZW1wbGF0ZT5cbiAgPGgxPnt7IGNvdW50IH19PC9oMT5cbiAgPGJ1dHRvbiBAY2xpY2s9XCJhZGRcIj5jaGlsZCBhZGQ8L2J1dHRvbj5cbiAgXG48L3RlbXBsYXRlPiJ9"></iframe>

可以看到父组件干净又卫生，写v-model就是为了双向绑定。